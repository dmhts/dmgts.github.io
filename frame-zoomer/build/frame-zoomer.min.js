!function(){"use strict";for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),function(a,b){"use strict";var c=function(b){var c=this;if(!b)throw new Error("The options object has not been set");if(!b.image)throw new Error("The image option has not been set");this.options=this.extend({zoomRatio:1,animationDuration:1e3,zoomWindow:{width:"100%",height:"100%"},frame:{padding:10,opacity:.5,background:"green"}},b),this.animationParams={},this.zoomWindow=a.document.createElement("div"),this.imgWrapper=a.document.createElement("div"),this.img=this.options.image,this.frame=a.document.createElement("div"),0===this.img.naturalWidth?this.img.onload=function(){c._init()}:c._init()};c.prototype.addPx=function(a){return a+"px"},c.prototype.getImgNaturalHeight=function(){return this.img.naturalHeight*this.options.zoomRatio},c.prototype.getImgNaturalWidth=function(){return this.img.naturalWidth*this.options.zoomRatio},c.prototype.drawFrame=function(a,b,c,d){var e=this._getImageScalingRatio();return this.frame.style.display="block",this.frame.style.left=this.addPx(e*a),this.frame.style.top=this.addPx(e*b),this.frame.style.width=this.addPx(e*c),this.frame.style.height=this.addPx(e*d),this},c.prototype.zoomIn=function(c,d,e,f,g,h){var i=this;this.animationParams.animationInProcess=!1,this.animationParams.initialX=this.animationParams.offsetX=(c-this.options.frame.padding/2)*this.options.zoomRatio,this.animationParams.initialY=this.animationParams.offsetY=(d-this.options.frame.padding/2)*this.options.zoomRatio,this.animationParams.frameWidth=(e+this.options.frame.padding)*this.options.zoomRatio,this.animationParams.frameHeight=(f+this.options.frame.padding)*this.options.zoomRatio,this.animationParams.isStickingRight=!1,this.animationParams.isStickingBottom=!1,this.animationParams.stickingRightPosition=b,this.animationParams.stickingBottomPosition=b,this.animationParams.start=Date.now(),this.animationParams.ratioProgress=b,this.animationParams.ratioWidth=b,this.hideFrame(),this._startAnimation(),"function"==typeof g&&g.apply(i,[i.animationParams]);var j=function(){i._calculateRatios()._scaleImage().drawFrame(i.animationParams.initialX,i.animationParams.initialY,i.animationParams.frameWidth,i.animationParams.frameHeight),i._setZoomWindowOffset("horizontal")._centerZoomWindowOffset("horizontal")._checkExceedingImageBoundaries("horizontal")._moveZoomWindow("horizontal"),i._setZoomWindowOffset("vertical")._centerZoomWindowOffset("vertical")._checkExceedingImageBoundaries("vertical")._moveZoomWindow("vertical"),i.animationParams.ratioProgress<1&&i.img.offsetWidth<=i.getImgNaturalWidth()&&i.frame.offsetWidth<i.zoomWindow.offsetWidth?requestAnimationFrame(j):(i._stopAnimation(),"function"==typeof h&&h.apply(i,[i.animationParams]))};return a.requestAnimationFrame(j),this},c.prototype.zoomOut=function(){return this.hideFrame(),this._setInitialStyle(),this},c.prototype.getFrameOffsetInsideZoomWindow=function(a){switch(a){case"horizontal":return parseFloat(this.frame.style.left)-(this.animationParams.isStickingRight?this.animationParams.stickingRightPosition:this.animationParams.offsetX);case"vertical":return parseFloat(this.frame.style.top)-(this.animationParams.isStickingBottom?this.animationParams.stickingBottomPosition:this.animationParams.offsetY)}},c.prototype.getFrameOffsetLimitInsideZoomWindow=function(a){switch(a){case"horizontal":return this.zoomWindow.offsetWidth/2-this.animationParams.frameWidth/2;case"vertical":return this.zoomWindow.offsetHeight/2-this.animationParams.frameHeight/2}},c.prototype.getFrameLeftOffsetInsideZoomWindow=function(){return this.animationParams.offsetX+this.zoomWindow.offsetWidth-(parseFloat(this.frame.style.left)+this.frame.offsetWidth)},c.prototype.isFrameRightmostEdgeVisible=function(){return this.getFrameLeftOffsetInsideZoomWindow()>0},c.prototype.isFrameExceedOffsetLimit=function(a){switch(a){case"horizontal":return this.getFrameOffsetInsideZoomWindow(a)<this.getFrameOffsetLimitInsideZoomWindow(a);case"vertical":return this.getFrameOffsetInsideZoomWindow(a)<this.getFrameOffsetLimitInsideZoomWindow(a)}},c.prototype.hideFrame=function(){this.frame.style.display="none"},c.prototype.wrap=function(a,b){b.length||(b=[b]);for(var c=b.length-1;c>=0;c--){var d=a,e=b[c],f=e.parentNode,g=e.nextSibling;d.appendChild(e),g?f.insertBefore(d,g):f.appendChild(d)}return a},c.prototype.extend=function(a,b){for(var c in b)try{a[c]=b[c].constructor===Object?this.extend(a[c],b[c]):b[c]}catch(d){a[c]=b[c]}return a},c.prototype._checkImageBoundaries=function(){if(this.getImgNaturalWidth()<=this.zoomWindow.offsetWidth)throw new Error("The width of the original image is less than width of the zoom window. Please increase the zoomRatio value.");if(this.getImgNaturalHeight()<=this.zoomWindow.offsetHeight)throw new Error("The height of the original image is less than height of the zoom window. Please increase the zoomRatio value.")},c.prototype._init=function(){return this.zoomWindow.setAttribute("id","zoomWindow"),this.zoomWindow.style.width="string"==typeof this.options.zoomWindow.width?this.options.zoomWindow.width:this.addPx(this.options.zoomWindow.width),this.zoomWindow.style.height="string"==typeof this.options.zoomWindow.height?this.options.zoomWindow.height:this.addPx(this.options.zoomWindow.height),this.zoomWindow.style.overflow="hidden",this.zoomWindow.style.position="relative",this.imgWrapper.setAttribute("id","wrapper"),this.imgWrapper.style.position="relative",this.img.style.width="100%",this.frame.style.background=this.options.frame.background,this.frame.style.opacity=this.options.frame.opacity,this.frame.style.display="none",this.frame.style.zIndex="100",this.frame.style.position="absolute",this.wrap(this.imgWrapper,this.img),this.wrap(this.zoomWindow,this.imgWrapper),this.imgWrapper.appendChild(this.frame),this._checkImageBoundaries(),this},c.prototype._stickZoomWindowToFrameRightEdge=function(){return this.animationParams.offsetX=this.animationParams.offsetX-this.getFrameLeftOffsetInsideZoomWindow(),this},c.prototype._stickZoomWindowToFrameOffsetLimit=function(a){switch(a){case"horizontal":this.animationParams.offsetX=parseFloat(this.frame.style.left)-this.getFrameOffsetLimitInsideZoomWindow(a),this.animationParams.offsetX=this.animationParams.offsetX>0?this.animationParams.offsetX:0;break;case"vertical":this.animationParams.offsetY=parseFloat(this.frame.style.top)-this.getFrameOffsetLimitInsideZoomWindow(a),this.animationParams.offsetY=this.animationParams.offsetY>0?this.animationParams.offsetY:0}return this},c.prototype._stickZoomWindowToImageBoundary=function(a){switch(a){case"horizontal":this.animationParams.stickingRightPosition=this.img.offsetWidth-this.zoomWindow.offsetWidth;break;case"vertical":this.animationParams.stickingBottomPosition=this.img.offsetHeight-this.zoomWindow.offsetHeight}return this},c.prototype._setZoomWindowOffset=function(a){switch(a){case"horizontal":this.animationParams.offsetX=this.animationParams.initialX*this.animationParams.ratioProgress;break;case"vertical":this.animationParams.offsetY=this.animationParams.initialY*this.animationParams.ratioProgress}return this},c.prototype._centerZoomWindowOffset=function(a){switch(a){case"horizontal":this.isFrameRightmostEdgeVisible()?this.isFrameExceedOffsetLimit(a)&&this._stickZoomWindowToFrameOffsetLimit(a):this._stickZoomWindowToFrameRightEdge();break;case"vertical":this.isFrameExceedOffsetLimit(a)&&this._stickZoomWindowToFrameOffsetLimit(a)}return this},c.prototype._checkExceedingImageBoundaries=function(a){switch(a){case"horizontal":this.animationParams.isStickingRight=this.img.offsetWidth-(this.animationParams.offsetX+this.zoomWindow.offsetWidth)<0,this.animationParams.isStickingRight&&this._stickZoomWindowToImageBoundary(a);break;case"vertical":this.animationParams.isStickingBottom=this.img.offsetHeight-(this.animationParams.offsetY+this.zoomWindow.offsetHeight)<0,this.animationParams.isStickingBottom&&this._stickZoomWindowToImageBoundary(a)}return this},c.prototype._moveZoomWindow=function(a){switch(a){case"horizontal":this.imgWrapper.style.right=this.addPx(this.animationParams.isStickingRight?this.animationParams.stickingRightPosition:this.animationParams.offsetX);break;case"vertical":this.imgWrapper.style.bottom=this.addPx(this.animationParams.isStickingBottom?this.animationParams.stickingBottomPosition:this.animationParams.offsetY)}return this},c.prototype._scaleImage=function(){return this.imgWrapper.style.width=this.addPx(this.getImgNaturalWidth()*this.animationParams.ratioWidth+this.zoomWindow.offsetWidth),this},c.prototype._calculateRatios=function(){var a=(Date.now()-this.animationParams.start)/this.options.animationDuration;return this.animationParams.ratioProgress=a>1?1:a,this.animationParams.ratioWidth=a-a*this._getInitialImageScalingRatio(),this},c.prototype.isAnimationInProcess=function(){return this.animationParams.animationInProcess},c.prototype._startAnimation=function(){this.animationParams.animationInProcess=!0},c.prototype._stopAnimation=function(){this.animationParams.animationInProcess=!1},c.prototype._getImageScalingRatio=function(){return parseFloat(this.img.offsetWidth)/parseFloat(this.getImgNaturalWidth())},c.prototype._getInitialImageScalingRatio=function(){return parseFloat(this.zoomWindow.offsetWidth)/parseFloat(this.getImgNaturalWidth())},c.prototype._setInitialStyle=function(){return this._stopAnimation(),this.imgWrapper.style.width="100%",this.imgWrapper.style.right=0,this.imgWrapper.style.bottom=0,this.frame.style.width=0,this.frame.style.height=0,this.frame.style.top=0,this.frame.style.left=0,this},"function"==typeof define&&define.amd?define(function(){return c}):a.FrameZoomer=c}(window);